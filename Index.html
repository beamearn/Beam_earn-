
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beam Earn - Earn Money Daily</title>
    <style>
        :root {
            --primary: #7E57C2;
            --primary-dark: #5E35B1;
            --secondary: #FF4081;
            --accent: #00E5FF;
            --success: #00C853;
            --warning: #FF9100;
            --danger: #FF1744;
            --dark: #1A237E;
            --light: #E8EAF6;
            --white: #FFFFFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }

        .header {
            background: var(--white);
            padding: 1rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .main {
            margin-top: 80px;
            padding: 1rem;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
            padding-bottom: 80px;
        }

        .card {
            background: var(--white);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
        }

        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            display: block;
            width: 100%;
            margin: 0.5rem 0;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary), var(--primary-dark));
            color: var(--white);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(126, 87, 194, 0.4);
        }

        .btn-success {
            background: linear-gradient(45deg, var(--success), #00E676);
            color: var(--white);
        }

        .btn-warning {
            background: linear-gradient(45deg, var(--warning), #FF6D00);
            color: var(--white);
        }

        .btn-danger {
            background: linear-gradient(45deg, var(--danger), #D50000);
            color: var(--white);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .stat-amount {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .level-card {
            background: var(--white);
            border: 3px solid var(--light);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .level-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .level-card.premium {
            border-color: var(--secondary);
            background: linear-gradient(135deg, #FFF, #FFEBEE);
        }

        .level-badge {
            background: var(--secondary);
            color: var(--white);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
        }

        .level-badge.free {
            background: var(--success);
        }

        .task-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .task-card {
            background: var(--white);
            border-left: 5px solid var(--success);
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .task-reward {
            color: var(--success);
            font-weight: bold;
            font-size: 1.3rem;
            margin: 1rem 0;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input {
            width: 100%;
            padding: 15px;
            border: 2px solid #E1E1E1;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(126, 87, 194, 0.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            padding: 1rem;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--white);
            border-radius: 20px;
            padding: 2rem;
            margin: 10% auto;
            max-width: 500px;
            position: relative;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close {
            position: absolute;
            top: 1rem;
            right: 1.5rem;
            font-size: 2rem;
            cursor: pointer;
            color: var(--dark);
        }

        .payment-number {
            background: linear-gradient(45deg, var(--success), #00E676);
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 1.5rem 0;
            box-shadow: 0 5px 15px rgba(0,200,83,0.3);
        }

        .support-section {
            background: linear-gradient(135deg, var(--primary), var(--dark));
            color: white;
            padding: 2rem;
            border-radius: 20px;
            text-align: center;
            margin: 2rem 0;
        }

        .support-contact {
            font-size: 1.2rem;
            font-weight: bold;
            margin: 1rem 0;
            background: rgba(255,255,255,0.2);
            padding: 1rem;
            border-radius: 15px;
            display: inline-block;
        }

        .daily-bonus-section {
            background: linear-gradient(135deg, #FFD700, #FF6B00);
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            margin: 1.5rem 0;
            box-shadow: 0 5px 15px rgba(255, 107, 0, 0.3);
        }

        .bonus-claimed {
            background: linear-gradient(135deg, var(--success), #00C853);
        }

        .bonus-amount {
            font-size: 2rem;
            font-weight: bold;
            margin: 1rem 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .referral-section {
            background: linear-gradient(135deg, var(--success), #00C853);
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin: 1.5rem 0;
        }

        .tax-notice {
            background: var(--light);
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            border-left: 4px solid var(--warning);
        }

        .countdown-timer {
            background: linear-gradient(45deg, var(--warning), var(--secondary));
            color: white;
            padding: 1rem;
            border-radius: 15px;
            text-align: center;
            margin: 1rem 0;
            font-weight: bold;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: var(--white);
            display: flex;
            padding: 0.8rem;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 0.5rem;
            color: var(--dark);
            text-decoration: none;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .nav-item.active {
            color: var(--primary);
            transform: translateY(-5px);
        }

        .nav-item i {
            display: block;
            font-size: 1.5rem;
            margin-bottom: 0.3rem;
        }

        .hidden { display: none; }
        .text-center { text-align: center; }
        .text-success { color: var(--success); }
        .text-danger { color: var(--danger); }
        .mb-1 { margin-bottom: 1rem; }
        .mb-2 { margin-bottom: 2rem; }
        .mt-1 { margin-top: 1rem; }
        .mt-2 { margin-top: 2rem; }

        /* Responsive */
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .level-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                margin: 20% 1rem;
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Clean Header - No Admin Buttons -->
    <header class="header">
        <div class="nav">
            <div class="logo">üöÄ Beam Earn</div>
            <div class="nav-auth">
                <button class="btn btn-primary" onclick="showAuth('login')" style="padding: 10px 20px; width: auto;">Login</button>
            </div>
        </div>
    </header>

    <!-- Main Content - Only User Sections -->
    <main class="main">
        <!-- Dashboard -->
        <section id="dashboard">
            <!-- Daily Bonus Section -->
            <div id="dailyBonusSection" class="daily-bonus-section">
                <h2>üéÅ Daily Login Bonus!</h2>
                <div class="bonus-amount">25 UGX</div>
                <p>Login every day to claim your bonus!</p>
                <button id="claimBonusBtn" class="btn btn-success" onclick="claimDailyBonus()" style="background: white; color: #FF6B00; font-weight: bold;">
                    üéØ Claim Your 25 UGX!
                </button>
                <div id="bonusStatus" style="margin-top: 1rem; font-size: 0.9rem;"></div>
            </div>

            <!-- Welcome Banner -->
            <div class="card text-center">
                <h1 style="color: var(--primary); margin-bottom: 1rem;">Welcome to Beam Earn! üí´</h1>
                <p style="font-size: 1.2rem; color: var(--dark);">Start earning real money today - No experience needed!</p>
            </div>

            <!-- Countdown Timer for Intern -->
            <div id="internCountdown" class="countdown-timer">
                <h3>‚è≥ Intern Period Ends In:</h3>
                <div id="countdownDisplay" style="font-size: 1.5rem;">2 days 00:00:00</div>
                <p>Upgrade to continue earning after your intern period!</p>
            </div>

            <!-- User Stats -->
            <div id="userStats">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Available Balance</div>
                        <div class="stat-amount" id="availableBalance">0 UGX</div>
                        <small>Ready to withdraw</small>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">VIP Level</div>
                        <div class="stat-amount" id="vipLevel">INTERN</div>
                        <small>Current level</small>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Referrals</div>
                        <div class="stat-amount" id="referralCount">0</div>
                        <small>Total referrals</small>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Referral Earnings</div>
                        <div class="stat-amount" id="referralEarnings">0 UGX</div>
                        <small>From referrals</small>
                    </div>
                </div>
            </div>

            <!-- Referral Section -->
            <div id="referralSection" class="referral-section">
                <h3>üë• Your Referral Code</h3>
                <div class="referral-code" style="font-size: 1.5rem; font-weight: bold; letter-spacing: 2px; margin: 1rem 0;" id="userReferralCode">LOADING...</div>
                <p>Share your code and earn <strong>5%</strong> of your referrals' earnings!</p>
                <p>Refer <strong>50 people</strong> to automatically upgrade from Intern to S1! üéâ</p>
                <button class="btn btn-warning" onclick="shareReferral()">üì§ Share Referral Code</button>
            </div>

            <!-- Tax Notice -->
            <div class="tax-notice">
                <h4>‚ö†Ô∏è Withdrawal Tax Information</h4>
                <p><strong>1,000 UGX tax</strong> will be deducted for every <strong>5,000 UGX</strong> withdrawn</p>
                <p><em>Example: Withdraw 5,000 UGX ‚Üí Receive 4,000 UGX</em></p>
            </div>

            <!-- VIP Levels -->
            <div class="card">
                <h2 style="color: var(--primary); text-align: center; margin-bottom: 1.5rem;">üåü Investment Levels</h2>
                <div class="level-grid">
                    <!-- Intern Level -->
                    <div class="level-card">
                        <div class="level-badge free">FREE</div>
                        <h3>Intern Level</h3>
                        <div style="color: var(--success); font-size: 1.3rem; font-weight: bold; margin: 1rem 0;">
                            üí∞ 1,000 UGX/day
                        </div>
                        <p>üìã 2 questions daily</p>
                        <p>‚è∞ 2 days only</p>
                        <p>üéØ Perfect for beginners</p>
                        <button class="btn btn-success" onclick="activateIntern()">Start FREE Trial</button>
                    </div>

                    <!-- S1 Level -->
                    <div class="level-card premium">
                        <div class="level-badge">S1</div>
                        <h3>Silver Level</h3>
                        <div style="color: var(--secondary); font-size: 1.3rem; font-weight: bold; margin: 1rem 0;">
                            üí∞ 1,388 UGX/day
                        </div>
                        <p>üíµ Investment: 40,000 UGX</p>
                        <p>üìã 4 questions daily</p>
                        <p>üìà Unlimited duration</p>
                        <button class="btn btn-primary" onclick="showDepositModal('S1', 40000)">Upgrade to S1</button>
                    </div>

                    <!-- S2 Level -->
                    <div class="level-card premium">
                        <div class="level-badge">S2</div>
                        <h3>Gold Level</h3>
                        <div style="color: var(--warning); font-size: 1.3rem; font-weight: bold; margin: 1rem 0;">
                            üí∞ 4,816 UGX/day
                        </div>
                        <p>üíµ Investment: 200,000 UGX</p>
                        <p>üìã 8 questions daily</p>
                        <p>üöÄ Higher earnings</p>
                        <button class="btn btn-warning" onclick="showDepositModal('S2', 200000)">Upgrade to S2</button>
                    </div>

                    <!-- S3 Level -->
                    <div class="level-card premium">
                        <div class="level-badge">S3</div>
                        <h3>Diamond Level</h3>
                        <div style="color: var(--danger); font-size: 1.3rem; font-weight: bold; margin: 1rem 0;">
                            üí∞ 9,708 UGX/day
                        </div>
                        <p>üíµ Investment: 500,000 UGX</p>
                        <p>üìã 12 questions daily</p>
                        <p>üíé Premium level</p>
                        <button class="btn btn-danger" onclick="showDepositModal('S3', 500000)">Upgrade to S3</button>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="card">
                <h3 style="color: var(--primary); margin-bottom: 1rem;">Quick Actions</h3>
                <button class="btn btn-primary mb-1" onclick="showSection('tasks')">üìã Answer Questions</button>
                <button class="btn btn-success mb-1" onclick="showSection('wallet')">üí∞ Wallet & Withdraw</button>
                <button class="btn btn-warning" onclick="showSection('support')">üõü Contact Support</button>
            </div>
        </section>

        <!-- Tasks Section -->
        <section id="tasks" class="hidden">
            <div class="card">
                <h2 style="color: var(--primary); text-align: center;">üìã Daily Questions</h2>
                <p class="text-center">Answer your daily questions to earn money</p>
                
                <div id="dailyTaskStatus" class="mb-2" style="text-align: center; font-weight: bold;"></div>
                
                <div id="tasksContainer">
                    <!-- Questions will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Wallet Section -->
        <section id="wallet" class="hidden">
            <div class="card">
                <h2 style="color: var(--primary); text-align: center;">üí∞ My Wallet</h2>
                
                <!-- Balance Overview -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Available Balance</div>
                        <div class="stat-amount" id="walletBalance">0 UGX</div>
                        <small>Ready to withdraw</small>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Referral Earnings</div>
                        <div class="stat-amount" id="walletReferral">0 UGX</div>
                        <small>From referrals</small>
                    </div>
                </div>

                <!-- Withdrawal Section -->
                <div class="card" style="background: var(--light);">
                    <h3>üí∏ Withdraw Funds</h3>
                    <p>Withdrawal hours: 9:00 AM - 10:00 PM</p>
                    <p>Minimum: 50,000 UGX | Maximum: 500,000 UGX per day</p>
                    
                    <div class="input-group">
                        <input type="number" id="withdrawAmount" class="input" placeholder="Enter amount (50,000 - 500,000 UGX)" min="50000" max="500000">
                    </div>
                    <div class="input-group">
                        <select id="withdrawMethod" class="input">
                            <option value="mtn">MTN Mobile Money</option>
                            <option value="airtel">Airtel Money</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <input type="tel" id="withdrawPhone" class="input" placeholder="Your phone number">
                    </div>
                    <button class="btn btn-success" onclick="processWithdrawal()">Request Withdrawal</button>
                </div>

                <!-- Transaction History -->
                <div class="mt-2">
                    <h3>üìä Transaction History</h3>
                    <div id="transactionList">
                        <p class="text-center">No transactions yet</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Support Section -->
        <section id="support" class="hidden">
            <div class="support-section">
                <h2>üõü Need Help?</h2>
                <p>Our support team is here to assist you 24/7</p>
                
                <div class="support-contact">
                    üí¨ Telegram: @Beam_earn
                </div>
                
                <p>‚è∞ Response time: Within 2 hours</p>
                
                <button class="btn btn-warning" onclick="openTelegram()" style="margin-top: 1rem;">
                    ‚úàÔ∏è Message on Telegram
                </button>
            </div>

            <div class="card">
                <h3 style="color: var(--primary);">üìû Contact Support</h3>
                <div class="input-group">
                    <input type="text" id="supportName" class="input" placeholder="Your Name">
                </div>
                <div class="input-group">
                    <input type="tel" id="supportPhone" class="input" placeholder="Your Phone Number">
                </div>
                <div class="input-group">
                    <textarea id="supportMessage" class="input" placeholder="Describe your issue..." rows="4"></textarea>
                </div>
                <button class="btn btn-primary" onclick="sendSupportMessage()">Send Message</button>
            </div>
        </section>
    </main>

    <!-- Bottom Navigation - Only User Tabs -->
    <nav class="bottom-nav">
        <a class="nav-item active" onclick="showSection('dashboard')">
            <span>üè†</span>
            <span>Home</span>
        </a>
        <a class="nav-item" onclick="showSection('tasks')">
            <span>üìã</span>
            <span>Questions</span>
        </a>
        <a class="nav-item" onclick="showSection('wallet')">
            <span>üí∞</span>
            <span>Wallet</span>
        </a>
        <a class="nav-item" onclick="showSection('support')">
            <span>üõü</span>
            <span>Support</span>
        </a>
    </nav>

    <!-- Auth Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideAuth()">&times;</span>
            <div id="authContent"></div>
        </div>
    </div>

    <!-- Deposit Modal -->
    <div id="depositModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideDepositModal()">&times;</span>
            <div id="depositContent"></div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal">
        <div class="modal-content">
            <h3 class="text-center" style="color: var(--success);">üéâ Success!</h3>
            <p id="successMessage" class="text-center"></p>
            <button class="btn btn-primary" onclick="hideSuccessModal()">OK</button>
        </div>
    </div>

    <script>
        // Data Management
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        let users = JSON.parse(localStorage.getItem('users')) || [];
        let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
        let pendingPayments = JSON.parse(localStorage.getItem('pendingPayments')) || [];

        // 50 Random Questions
        const questions = [
            "What is the capital city of Uganda?",
            "Name the longest river in Africa.",
            "What is 15 + 27?",
            "Which planet is known as the Red Planet?",
            "What is the main ingredient in bread?",
            "How many sides does a hexagon have?",
            "What is the chemical symbol for gold?",
            "Who wrote 'Romeo and Juliet'?",
            "What is the largest mammal in the world?",
            "Which country is known as the Land of the Rising Sun?",
            "What is the square root of 64?",
            "Name the process by which plants make their food.",
            "What is the currency of Kenya?",
            "How many continents are there?",
            "What is the freezing point of water in Celsius?",
            "Who painted the Mona Lisa?",
            "What is the tallest mountain in Africa?",
            "What is 8 x 9?",
            "Which gas do plants absorb from the atmosphere?",
            "What is the largest ocean on Earth?",
            "Name the first element on the periodic table.",
            "What is the main language spoken in Brazil?",
            "How many days are in a leap year?",
            "What is the capital of Tanzania?",
            "What is 25% of 200?",
            "Which animal is known as the King of the Jungle?",
            "What is the boiling point of water in Celsius?",
            "Who discovered gravity?",
            "What is the smallest country in the world?",
            "How many bones are in the human body?",
            "What is the chemical formula for water?",
            "Which planet is closest to the Sun?",
            "What is the largest desert in the world?",
            "Name the longest bone in the human body.",
            "What is 144 √∑ 12?",
            "Which country has the most population?",
            "What is the main gas found in the Earth's atmosphere?",
            "Who invented the telephone?",
            "What is the capital of Rwanda?",
            "How many colors are in a rainbow?",
            "What is 7 squared?",
            "Which animal can change its color?",
            "What is the hardest natural substance on Earth?",
            "Name the fastest land animal.",
            "What is 3/4 as a percentage?",
            "Which organ pumps blood throughout the body?",
            "What is the capital of Nigeria?",
            "How many hours are in 3 days?",
            "What is the chemical symbol for iron?",
            "Who was the first president of Uganda?"
        ];

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            loadTransactionHistory();
            startCountdownTimer();
        });

        // Authentication Functions
        function showAuth(type) {
            const modal = document.getElementById('authModal');
            const content = document.getElementById('authContent');
            
            if (type === 'register') {
                content.innerHTML = `
                    <h3 class="text-center" style="color: var(--primary);">Join Beam Earn üöÄ</h3>
                    <div class="input-group">
                        <input type="text" id="regName" class="input" placeholder="Full Name" required>
                    </div>
                    <div class="input-group">
                        <input type="tel" id="regPhone" class="input" placeholder="Phone Number" required>
                    </div>
                    <div class="input-group">
                        <input type="password" id="regPassword" class="input" placeholder="Password" required>
                    </div>
                    <div class="input-group">
                        <input type="text" id="regReferral" class="input" placeholder="Referral Code (Optional)">
                    </div>
                    <button class="btn btn-primary" onclick="register()">Create Account</button>
                    <p class="text-center mt-2">
                        Already have an account? <a href="#" onclick="showAuth('login')" style="color: var(--primary);">Login</a>
                    </p>
                `;
            } else {
                content.innerHTML = `
                    <h3 class="text-center" style="color: var(--primary);">Welcome Back! üëã</h3>
                    <div class="input-group">
                        <input type="tel" id="loginPhone" class="input" placeholder="Phone Number" required>
                    </div>
                    <div class="input-group">
                        <input type="password" id="loginPassword" class="input" placeholder="Password" required>
                    </div>
                    <button class="btn btn-primary" onclick="login()">Login</button>
                    <p class="text-center mt-2">
                        Don't have an account? <a href="#" onclick="showAuth('register')" style="color: var(--primary);">Register</a>
                    </p>
                `;
            }
            
            modal.style.display = 'block';
        }

        function hideAuth() {
            document.getElementById('authModal').style.display = 'none';
        }

        function register() {
            const name = document.getElementById('regName').value;
            const phone = document.getElementById('regPhone').value;
            const password = document.getElementById('regPassword').value;
            const referralCode = document.getElementById('regReferral').value;

            if (users.find(u => u.phone === phone)) {
                showSuccess('Phone number already registered!', 'error');
                return;
            }

            // Generate unique referral code
            const userReferralCode = generateReferralCode();
            
            const user = {
                id: Date.now().toString(),
                name,
                phone,
                password,
                referralCode: userReferralCode,
                referredBy: referralCode || null,
                level: 'intern',
                balance: 0,
                referralEarnings: 0,
                referralCount: 0,
                referrals: [],
                totalEarned: 0,
                internStartDate: new Date().toISOString(),
                internDaysLeft: 2,
                tasksCompleted: 0,
                joinedDate: new Date().toISOString(),
                lastActive: new Date().toISOString(),
                lastBonusClaim: '',
                lastTaskDate: '',
                dailyQuestionsCompleted: 0
            };

            users.push(user);
            localStorage.setItem('users', JSON.stringify(users));
            
            // Handle referral
            if (referralCode) {
                const referrer = users.find(u => u.referralCode === referralCode);
                if (referrer) {
                    referrer.referralCount += 1;
                    referrer.referrals.push({
                        name: name,
                        phone: phone,
                        date: new Date().toISOString()
                    });
                    localStorage.setItem('users', JSON.stringify(users));
                    
                    // Check if referrer should be upgraded (50 referrals)
                    if (referrer.level === 'intern' && referrer.referralCount >= 50) {
                        referrer.level = 'S1';
                        showSuccess(`üéâ Congratulations! You've been upgraded to S1 for referring 50 people!`);
                    }
                }
            }
            
            currentUser = user;
            localStorage.setItem('currentUser', JSON.stringify(user));
            
            showSuccess('Welcome to Beam Earn! üéâ You have 2 days FREE intern access!');
            hideAuth();
            checkAuthStatus();
            startCountdownTimer();
        }

        function login() {
            const phone = document.getElementById('loginPhone').value;
            const password = document.getElementById('loginPassword').value;

            const user = users.find(u => u.phone === phone && u.password === password);

            if (user) {
                // Update last active
                user.lastActive = new Date().toISOString();
                users = users.map(u => u.id === user.id ? user : u);
                localStorage.setItem('users', JSON.stringify(users));
                
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                checkAuthStatus();
                hideAuth();
                showSuccess(`Welcome back, ${user.name}! üëã`);
                startCountdownTimer();
            } else {
                showSuccess('Invalid phone number or password!', 'error');
            }
        }

        function checkAuthStatus() {
            const userStats = document.getElementById('userStats');
            const referralSection = document.getElementById('referralSection');
            const dailyBonusSection = document.getElementById('dailyBonusSection');
            const navAuth = document.querySelector('.nav-auth');

            if (currentUser) {
                userStats.classList.remove('hidden');
                referralSection.classList.remove('hidden');
                dailyBonusSection.classList.remove('hidden');
                navAuth.innerHTML = `
                    <span style="margin-right: 1rem; color: var(--primary); font-weight: 600;">Hi, ${currentUser.name}</span>
                    <button class="btn btn-warning" onclick="logout()" style="padding: 8px 15px; width: auto;">Logout</button>
                `;
                updateUserStats();
                
                // Show countdown if user is intern
                if (currentUser.level === 'intern' && currentUser.internDaysLeft > 0) {
                    document.getElementById('internCountdown').classList.remove('hidden');
                }
                
                // Update referral code display
                document.getElementById('userReferralCode').textContent = currentUser.referralCode;
                
                // Check daily bonus
                checkDailyBonus();
            } else {
                userStats.classList.add('hidden');
                referralSection.classList.add('hidden');
                dailyBonusSection.classList.add('hidden');
                document.getElementById('internCountdown').classList.add('hidden');
                navAuth.innerHTML = `
                    <button class="btn btn-primary" onclick="showAuth('login')" style="padding: 10px 20px; width: auto;">Login</button>
                `;
            }
        }

        function updateUserStats() {
            if (!currentUser) return;
            
            document.getElementById('availableBalance').textContent = currentUser.balance.toLocaleString() + ' UGX';
            document.getElementById('vipLevel').textContent = currentUser.level.toUpperCase();
            document.getElementById('referralCount').textContent = currentUser.referralCount;
            document.getElementById('referralEarnings').textContent = currentUser.referralEarnings.toLocaleString() + ' UGX';
            document.getElementById('walletBalance').textContent = currentUser.balance.toLocaleString() + ' UGX';
            document.getElementById('walletReferral').textContent = currentUser.referralEarnings.toLocaleString() + ' UGX';
        }

        // Countdown Timer for Intern
        function startCountdownTimer() {
            if (!currentUser || currentUser.level !== 'intern') return;
            
            const countdownElement = document.getElementById('countdownDisplay');
            const internStart = new Date(currentUser.internStartDate);
            const endDate = new Date(internStart.getTime() + (2 * 24 * 60 * 60 * 1000)); // 2 days
            
            function updateCountdown() {
                const now = new Date().getTime();
                const distance = endDate - now;
                
                if (distance < 0) {
                    countdownElement.textContent = "EXPIRED";
                    currentUser.level = 'expired';
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    showSuccess('Your intern period has ended. Please upgrade to continue earning!');
                    return;
                }
                
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                
                countdownElement.textContent = `${days} days ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            updateCountdown();
            setInterval(updateCountdown, 1000);
        }

        // Daily Bonus Functions
        function checkDailyBonus() {
            if (!currentUser) return;
            
            const today = new Date().toDateString();
            const lastClaimDate = currentUser.lastBonusClaim || '';
            
            const bonusSection = document.getElementById('dailyBonusSection');
            
            if (lastClaimDate === today) {
                // Already claimed today
                bonusSection.classList.add('bonus-claimed');
                bonusSection.innerHTML = `
                    <h2>‚úÖ Bonus Claimed Today!</h2>
                    <div class="bonus-amount">25 UGX</div>
                    <p>You've already claimed your daily bonus today</p>
                    <p>Come back tomorrow for another reward! üéâ</p>
                `;
            } else {
                // Bonus available
                bonusSection.classList.remove('bonus-claimed');
                bonusSection.innerHTML = `
                    <h2>üéÅ Daily Login Bonus!</h2>
                    <div class="bonus-amount">25 UGX</div>
                    <p>Login every day to claim your bonus!</p>
                    <button id="claimBonusBtn" class="btn btn-success" onclick="claimDailyBonus()" style="background: white; color: #FF6B00; font-weight: bold;">
                        üéØ Claim Your 25 UGX!
                    </button>
                    <div id="bonusStatus" style="margin-top: 1rem; font-size: 0.9rem;"></div>
                `;
            }
        }

        function claimDailyBonus() {
            if (!currentUser) {
                showSuccess('Please login first!', 'error');
                return;
            }
            
            const today = new Date().toDateString();
            const lastClaimDate = currentUser.lastBonusClaim || '';
            
            if (lastClaimDate === today) {
                showSuccess('You have already claimed your daily bonus today!', 'error');
                return;
            }
            
            // Add bonus to user balance (25 UGX)
            currentUser.balance += 25;
            currentUser.totalEarned += 25;
            currentUser.lastBonusClaim = today;
            
            // Update user data
            users = users.map(u => u.id === currentUser.id ? currentUser : u);
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // Add transaction
            addTransaction(currentUser.id, 25, 'daily_bonus', 'Daily login bonus');
            
            showSuccess('üéâ Daily bonus claimed! 25 UGX added to your balance!');
            updateUserStats();
            checkDailyBonus();
        }

        // Task System - Questions
        function loadTasks() {
            if (!currentUser) return;
            
            const container = document.getElementById('tasksContainer');
            const statusElement = document.getElementById('dailyTaskStatus');
            const today = new Date().toDateString();
            
            // Reset daily questions if it's a new day
            if (currentUser.lastTaskDate !== today) {
                currentUser.dailyQuestionsCompleted = 0;
                currentUser.lastTaskDate = today;
                users = users.map(u => u.id === currentUser.id ? currentUser : u);
                localStorage.setItem('users', JSON.stringify(users));
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
            }
            
            const userLevel = currentUser.level;
            let questionLimit = 0;
            let rewardPerQuestion = 0;
            
            // Set question limit and reward based on level
            switch(userLevel) {
                case 'intern': 
                    questionLimit = 2; 
                    rewardPerQuestion = 500;
                    break;
                case 'S1': 
                    questionLimit = 4; 
                    rewardPerQuestion = 347;
                    break;
                case 'S2': 
                    questionLimit = 8; 
                    rewardPerQuestion = 602;
                    break;
                case 'S3': 
                    questionLimit = 12; 
                    rewardPerQuestion = 809;
                    break;
                default: 
                    questionLimit = 0;
                    rewardPerQuestion = 0;
            }
            
            // Check if user has completed all daily questions
            if (currentUser.dailyQuestionsCompleted >= questionLimit) {
                statusElement.innerHTML = `
                    <div style="background: var(--warning); color: white; padding: 1rem; border-radius: 10px;">
                        <h4>‚úÖ All Questions Completed Today!</h4>
                        <p>You've completed all ${questionLimit} questions for today. Come back tomorrow for more!</p>
                    </div>
                `;
                container.innerHTML = '';
                return;
            }
            
            statusElement.innerHTML = `
                <div style="background: var(--success); color: white; padding: 1rem; border-radius: 10px;">
                    <h4>üìã Daily Questions Progress</h4>
                    <p>Completed: ${currentUser.dailyQuestionsCompleted}/${questionLimit} | Reward: ${rewardPerQuestion} UGX per question</p>
                </div>
            `;
            
            // Get random questions
            const availableQuestions = [...questions];
            const selectedQuestions = [];
            
            for (let i = 0; i < questionLimit - currentUser.dailyQuestionsCompleted; i++) {
                if (availableQuestions.length === 0) break;
                const randomIndex = Math.floor(Math.random() * availableQuestions.length);
                selectedQuestions.push(availableQuestions[randomIndex]);
                availableQuestions.splice(randomIndex, 1);
            }
            
            let questionsHTML = '';
            selectedQuestions.forEach((question, index) => {
                questionsHTML += `
                    <div class="task-card">
                        <h4>Question ${index + 1 + currentUser.dailyQuestionsCompleted}</h4>
                        <p><strong>${question}</strong></p>
                        <div class="input-group">
                            <input type="text" id="answer-${index}" class="input" placeholder="Your answer">
                        </div>
                        <div class="task-reward">+${rewardPerQuestion} UGX</div>
                        <button class="btn btn-primary" onclick="answerQuestion(${index}, '${question}', ${rewardPerQuestion})">Submit Answer</button>
                    </div>
                `;
            });
            
            container.innerHTML = questionsHTML || '<p class="text-center">No questions available for your level</p>';
        }

        function answerQuestion(index, question, reward) {
            if (!currentUser) {
                showSuccess('Please login first!', 'error');
                return;
            }
            
            const answerInput = document.getElementById(`answer-${index}`);
            const answer = answerInput.value.trim();
            
            if (!answer) {
                showSuccess('Please enter an answer!', 'error');
                return;
            }
            
            // Add reward to balance (accept any answer)
            currentUser.balance += reward;
            currentUser.totalEarned += reward;
            currentUser.dailyQuestionsCompleted += 1;
            currentUser.tasksCompleted += 1;
            
            // Process referral earnings (5% to referrer)
            if (currentUser.referredBy) {
                const referrer = users.find(u => u.referralCode === currentUser.referredBy);
                if (referrer) {
                    const referralBonus = Math.floor(reward * 0.05); // 5%
                    referrer.balance += referralBonus;
                    referrer.referralEarnings += referralBonus;
                    
                    // Update referrer in users array
                    users = users.map(u => u.id === referrer.id ? referrer : u);
                    
                    // Add transaction for referrer
                    addTransaction(referrer.id, referralBonus, 'referral_bonus', `5% from ${currentUser.name}`);
                }
            }
            
            // Update user data
            users = users.map(u => u.id === currentUser.id ? currentUser : u);
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // Add transaction
            addTransaction(currentUser.id, reward, 'question_reward', `Answered: ${question}`);
            
            showSuccess(`Answer submitted! üéâ You earned ${reward} UGX`);
            updateUserStats();
            loadTransactionHistory();
            
            // Reload tasks to show updated progress
            setTimeout(() => {
                loadTasks();
            }, 1000);
        }

        // Deposit System
        function showDepositModal(level, amount) {
            if (!currentUser) {
                showSuccess('Please login first!', 'error');
                return;
            }
            
            const modal = document.getElementById('depositModal');
            const content = document.getElementById('depositContent');
            
            content.innerHTML = `
                <h3 class="text-center" style="color: var(--primary);">Upgrade to ${level} üí´</h3>
                <p class="text-center">Investment Amount: <strong>${amount.toLocaleString()} UGX</strong></p>
                
                <div class="payment-number">
                    üìû 0707275939
                </div>
                
                <div style="background: var(--light); padding: 1rem; border-radius: 10px; margin: 1rem 0;">
                    <h4>üìã Payment Instructions:</h4>
                    <ol style="text-align: left; margin: 1rem;">
                        <li>Send <strong>${amount.toLocaleString()} UGX</strong> to <strong>0707275939</strong></li>
                        <li>Include your name as reference</li>
                        <li>Take screenshot of transaction</li>
                        <li>Click "I Have Paid" below</li>
                        <li>Wait 24 hours for approval</li>
                        <li>We'll activate your ${level} level</li>
                    </ol>
                </div>
                
                <button class="btn btn-success" onclick="submitPayment('${level}', ${amount})">I Have Paid</button>
                <button class="btn btn-warning" onclick="openTelegram()" style="margin-top: 0.5rem;">üìû Contact Support</button>
            `;
            
            modal.style.display = 'block';
        }

        function hideDepositModal() {
            document.getElementById('depositModal').style.display = 'none';
        }

        function submitPayment(level, amount) {
            if (!currentUser) return;
            
            // Create pending payment
            const payment = {
                id: Date.now().toString(),
                userId: currentUser.id,
                userName: currentUser.name,
                userPhone: currentUser.phone,
                level: level,
                amount: amount,
                status: 'pending',
                date: new Date().toISOString(),
                approved: false
            };
            
            pendingPayments.push(payment);
            localStorage.setItem('pendingPayments', JSON.stringify(pendingPayments));
            
            showSuccess(`Payment submitted! üéâ We'll verify and activate your ${level} level within 24 hours.`);
            hideDepositModal();
        }

        // Withdrawal System with Tax
        function calculateWithdrawalTax(amount) {
            // Calculate tax: 1,000 UGX for every 5,000 UGX
            const taxRate = 1000 / 5000; // 20% tax
            const tax = Math.floor(amount * taxRate);
            return tax;
        }

        function processWithdrawal() {
            if (!currentUser) {
                showSuccess('Please login first!', 'error');
                return;
            }
            
            const amount = parseInt(document.getElementById('withdrawAmount').value);
            const method = document.getElementById('withdrawMethod').value;
            const phone = document.getElementById('withdrawPhone').value;
            
            // Validate amount
            if (!amount || amount < 50000 || amount > 500000) {
                showSuccess('Withdrawal amount must be between 50,000 UGX and 500,000 UGX', 'error');
                return;
            }
            
            if (amount > currentUser.balance) {
                showSuccess('Insufficient balance!', 'error');
                return;
            }
            
            if (!phone || phone.length !== 10) {
                showSuccess('Please enter a valid phone number', 'error');
                return;
            }
            
            // Check withdrawal hours (9 AM - 10 PM)
            const now = new Date();
            const currentHour = now.getHours();
            if (currentHour < 9 || currentHour >= 22) {
                showSuccess('Withdrawals are only processed between 9:00 AM and 10:00 PM', 'error');
                return;
            }
            
            // Calculate tax
            const tax = calculateWithdrawalTax(amount);
            const netAmount = amount - tax;
            
            // Process withdrawal
            currentUser.balance -= amount;
            users = users.map(u => u.id === currentUser.id ? currentUser : u);
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            addTransaction(currentUser.id, -amount, 'withdrawal', 
                `Withdrawal to ${phone} (Tax: ${tax} UGX, Net: ${netAmount} UGX)`);
            
            showSuccess(`Withdrawal request of ${amount.toLocaleString()} UGX submitted! üí∏<br>Tax: ${tax} UGX<br>You'll receive: ${netAmount.toLocaleString()} UGX`);
            updateUserStats();
            loadTransactionHistory();
            
            // Clear form
            document.getElementById('withdrawAmount').value = '';
            document.getElementById('withdrawPhone').value = '';
        }

        // Support System
        function openTelegram() {
            window.open('https://t.me/Beam_earn', '_blank');
        }

        function sendSupportMessage() {
            const name = document.getElementById('supportName').value;
            const phone = document.getElementById('supportPhone').value;
            const message = document.getElementById('supportMessage').value;
            
            if (!name || !phone || !message) {
                showSuccess('Please fill all fields', 'error');
                return;
            }
            
            const fullMessage = `Support Request from ${name} (${phone}): ${message}`;
            window.open(`https://t.me/Beam_earn?text=${encodeURIComponent(fullMessage)}`, '_blank');
            
            // Clear form
            document.getElementById('supportName').value = '';
            document.getElementById('supportPhone').value = '';
            document.getElementById('supportMessage').value = '';
            
            showSuccess('Message prepared! Opening Telegram...');
        }

        // Referral System
        function shareReferral() {
            if (!currentUser) return;
            
            const message = `Join Beam Earn and start earning money daily! Use my referral code: ${currentUser.referralCode}. Earn 1,000 UGX daily for FREE! üöÄ`;
            
            // Try to share using Web Share API
            if (navigator.share) {
                navigator.share({
                    title: 'Join Beam Earn',
                    text: message,
                    url: window.location.href
                });
            } else {
                // Fallback: copy to clipboard
                navigator.clipboard.writeText(message).then(() => {
                    showSuccess('Referral message copied to clipboard! üìã');
                });
            }
        }

        // Navigation
        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('main > section').forEach(sec => {
                sec.classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(section).classList.remove('hidden');
            
            // Update bottom nav
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const sectionIndex = ['dashboard', 'tasks', 'wallet', 'support'].indexOf(section);
            if (sectionIndex !== -1) {
                document.querySelectorAll('.nav-item')[sectionIndex].classList.add('active');
            }
            
            // Load section-specific content
            if (section === 'tasks') loadTasks();
            if (section === 'wallet') loadTransactionHistory();
        }

        // Utility Functions
        function generateReferralCode() {
            return Math.random().toString(36).substring(2, 8).toUpperCase();
        }

        function addTransaction(userId, amount, type, description) {
            const transaction = {
                id: Date.now().toString(),
                userId,
                amount,
                type,
                description,
                date: new Date().toISOString(),
                status: 'completed'
            };
            
            transactions.unshift(transaction);
            localStorage.setItem('transactions', JSON.stringify(transactions));
        }

        function loadTransactionHistory() {
            if (!currentUser) return;
            
            const transactionList = document.getElementById('transactionList');
            const userTransactions = transactions
                .filter(t => t.userId === currentUser.id)
                .slice(0, 10);
            
            if (userTransactions.length === 0) {
                transactionList.innerHTML = '<p class="text-center">No transactions yet</p>';
                return;
            }
            
            transactionList.innerHTML = userTransactions.map(transaction => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; border-bottom: 1px solid #eee;">
                    <div>
                        <strong>${transaction.description}</strong>
                        <div style="font-size: 0.9rem; color: #666;">
                            ${new Date(transaction.date).toLocaleDateString()}
                        </div>
                    </div>
                    <div style="color: ${transaction.amount > 0 ? 'var(--success)' : 'var(--danger)'}; font-weight: bold;">
                        ${transaction.amount > 0 ? '+' : ''}${transaction.amount.toLocaleString()} UGX
                    </div>
                </div>
            `).join('');
        }

        function showSuccess(message, type = 'success') {
            const modal = document.getElementById('successModal');
            const messageEl = document.getElementById('successMessage');
            
            messageEl.innerHTML = message;
            messageEl.style.color = type === 'error' ? 'var(--danger)' : 'var(--success)';
            modal.style.display = 'block';
        }

        function hideSuccessModal() {
            document.getElementById('successModal').style.display = 'none';
        }

        function activateIntern() {
            showAuth('register');
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            checkAuthStatus();
            showSuccess('Logged out successfully! üëã');
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const modals = document.getElementsByClassName('modal');
            for (let modal of modals) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            }
        }
    </script>
</body>
</html>
